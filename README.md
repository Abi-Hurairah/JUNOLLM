# AI-Powered Journaling API

This is a backend API for an intelligent journaling application, built with Python, FastAPI, and Google's Gemini LLM. It provides AI-driven analysis for journal entries and enables users to have natural language conversations with their entire journaling history.

## Core Features

-   **AI-Powered Analysis**: Submits journal entries to the Google Gemini API to get a `sentimentScore` (from -10 to 10) and a paragraph of supportive `counsel`.
-   **Structured AI Responses**: Uses `LangChain` with `PydanticOutputParser` to ensure reliable, structured JSON responses from the AI.
-   **Persistent Storage**: Fully integrated with a SQL database using `SQLModel` to store all user data, journal entries, and AI analysis results.
-   **Asynchronous Ready**: Built on FastAPI, providing a high-performance ASGI framework.
-   **Authentication Structure**: Includes a dependency injection system for user authentication, making it ready for a secure login implementation.

## Tech Stack

-   **Backend Framework**: FastAPI
-   **AI Integration**: LangChain, Google Gemini (`gemini-1.5-flash-latest`)
-   **Database ORM**: SQLModel
-   **Database**: MySQL (but adaptable to others like PostgreSQL)
-   **Dependencies**: See `requirements.txt`

---

## Project Setup

Follow these steps to get the application running locally.

### 1. Prerequisites

-   Python 3.10+
-   A running MySQL server (or other SQL database)
-   `uv` (or `pip`) for package management

### 2. Clone the Repository

```bash
git clone <your-repository-url>
cd <your-repository-folder>

3. Set Up the Environment
Create a virtual environment:

# Using uv
uv venv

# Activate the environment
source .venv/bin/activate

Install dependencies:

uv pip install -r requirements.txt

4. Configure Environment Variables
Create a file named .env in the root of the project folder. This file will hold your secret keys and database connection string. This file should never be committed to Git.

# .env file

# Your connection string for the database
# Example for MySQL:
DATABASE_URL="mysql+pymysql://YOUR_DB_USER:YOUR_DB_PASSWORD@localhost:3306/YOUR_DB_NAME"

# Your API key from Google AI Studio
GEMINI_API_KEY="PASTE_YOUR_GEMINI_API_KEY_HERE"

5. Initialize the Database
The application will automatically create the necessary tables the first time it starts, based on the schema in models.py.

Running the Application
With your virtual environment activated, run the following command to start the web server:

uvicorn main:app --reload

main: Refers to the main.py file.

app: Refers to the app = FastAPI() object inside the file.

--reload: Automatically restarts the server when you make code changes.

The server will be running at http://127.0.0.1:8000.

API Usage & Testing
The easiest way to test the API is through the interactive documentation automatically generated by FastAPI.

Run the server.

Open your web browser and navigate to http://127.0.0.1:8000/docs.

Endpoints
POST /analyze-entry
Description: Analyzes a new journal entry, saves it to the database, and returns the AI's analysis.

Headers: Requires an X-User-Id header with the integer ID of an existing user.

Request Body:

{
  "text": "Today was a difficult day. I struggled with my main project and feel overwhelmed.",
  "entry_status": "published"
}

Success Response:

{
  "sentimentScore": -7,
  "counsel": "It's completely understandable to feel overwhelmed when facing challenges with an important project. Remember that progress isn't always linear. Take a moment to step back and breathe..."
}
